<div id="info-scroller">
<ul>
<li>
    
    <h2><label for="info-title"></label>
    <span id="info-title"></span></h2>
    
    <h2><span id="info-venue"></span></h2>
    
    <h3><span id="info-date"></span></h3>    
    
    <h3><a id="info-tickets" target="_blank"></a></h3>
    
    <!-- <h3><label for="info-phone"></label>
    <a id="info-phone" target="_blank"></a></h3> -->
        
    <div data-role="collapsible" data-collapsed="false" data-theme="c" data-content-theme="c" style="border:0;padding:0;margin:0;">    
	    <h2><span id="info-artist"></span></h2>
	    <div id="info-artist-bio-wrapper" data-role="collapsible" data-collapsed="false" data-inset="false" data-theme="c" data-content-theme="c">    
	       <h3>Bio</h3>
	       <span id="info-artist-bio"></span>
	    </div>
		<img id="info-artist-image" style="max-width:320px;"></img>
	</div>
	
    <div data-role="collapsible" data-theme="c" data-content-theme="c">    
	   <h2>Next Artist</h2>
    </div>
    
	<br><br><br><br>
	


	<div style="position:absolute;bottom:2px;right:8px;">
	    <a href="http://soundcloud.com" target="_blank" title="SoundCloud">
	    <img id="soundcloud-logo" src="http://developers.soundcloud.com/assets/powered_by_large_black-e832a12f64d6ce6d2da947494e210e4d.png" alt="SoundCloud" border="0" /></a>
	    <a href="http://the.echonest.com" target="_blank" title="The Echo Nest">
	    <img id="echonest-logo" src="http://the.echonest.com/static/img/logos/EN_P_on_Light_Transparent.png" border="0" /></a>
		<a href="http://www.last.fm" target="_blank" title="Last.fm">
		<img id="lastfm-logo" src="http://cdn.last.fm/flatness/badges/lastfm_grey.gif" alt="Last.fm" border="0" /></a>
		<!--<a href="http://www.JamBase.com" target="_blank" title="JamBase Concert Search">
        <img id="jambase-logo" src="http://images.jambase.com/logos/jambase140x70.gif" alt="JamBase" border="0" /></a>-->
	</div>
</li>
</ul>
</div>

<script type="text/javascript">
function getBestBio(bios) {
    var best = null;
    if (bios.length > 0) {
        best = bios[0];
        for (var i = 0; i < bios.length; i++) {
            if (bios[i].site == 'wikipedia') {
                best = bios[i];
            }
        }
    }
    return best;
}


function getHumanDate(date){
    var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
    var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    var sup = "";

    switch(date.getDate()){
        case 1: case 21: case 31: sup="st"; break;
        case 2: case 22: sup="nd"; break;
        case 3: case 23: sup="rd"; break;
        default: sup="th";
    }

    var returnString = days[date.getDay()] + ", " + months[date.getMonth()] + " " + date.getDate() + "<sup>" + sup + "</sup>";
    return returnString;
}

function loadInfo(){
    var playing = $('li.playing');
    var artistID = playing.attr("name");
    var eventTitle = playing.attr("data-eventTitle");
    var venue = playing.attr("data-venue");
    var venueLat = playing.attr("data-venueLat");
    var venueLng = playing.attr("data-venueLng");
    var venuePhone = playing.attr("data-venuePhone");
    var date = new Date(playing.attr("data-date"));
    var ticketUrl = playing.attr("data-ticketUrl");

	requestArtistInfo(artistID);
    $("#info-title").html(eventTitle);
	$("#info-venue").html("@<a target='_blank' href='http://maps.google.com/?q="+encodeURIComponent(venue)+"&near="+venueLat+","+venueLng+"'>"+venue+"</a>");
	$("#info-date").html(getHumanDate(date) );
	if(ticketUrl == "" || ticketUrl == "undefined"){
        $("#info-tickets").text("");
        $("#info-tickets").attr("href","");
	}else{
		$("#info-tickets").text("Buy Tickets Here");
		$("#info-tickets").attr("href",ticketUrl);
	}
	if(venuePhone == "" || venuePhone == "undefined"){
		$("#info-phone").text("");
	    $("#info-phone").attr("href","");
	}else{
	    $("#info-phone").text(venuePhone);
	    $("#info-phone").attr("href","tel:"+venuePhone);
	}
	
}



function requestArtistInfo(artistID){
	var apiKey = "8C0DI9VHHE8BZSPOP";
	//var id = "jambase:artist:"+artistID;
	var name = encodeURIComponent(artistID);
    $.ajax({
        url : "http://developer.echonest.com/api/v4/artist/profile",
        dataType : 'json',
        data: 
        	'api_key='+ apiKey +
        	'&name='+ name +
        	'&bucket='+ "biographies" +
        	'&bucket='+ "familiarity" +
        	'&bucket='+ "hotttnesss" +
        	'&bucket='+ "images" +
        	'&bucket='+ "artist_location" +
        	'&bucket='+ "news" +
        	'&bucket='+ "reviews" +
        	'&bucket='+ "urls" +
        	'&bucket='+ "video" +
        	'&bucket='+ "years_active" +
        	'&bucket='+ "terms" +
        	'&format='+ "json",
        error : function() {
        	
        },
        success : function(data) {
        	var artistProfile = data.response.artist;
        	if(typeof artistProfile === "undefined"){
        		return;
        	}
            $("#info-artist").html(artistProfile.name);
            if(typeof artistProfile.images[0] !== "undefined"){
                $("#info-artist-image").load(function() { infoScroll.refresh();}).attr("src",artistProfile.images[0].url);  
            }
            if(typeof artistProfile.biographies[0] !== "undefined"){
            	$("#info-artist-bio").html(getBestBio(artistProfile.biographies).text);
            }
        }
    });
}



</script>